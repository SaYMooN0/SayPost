var $=i=>{throw TypeError(i)};var ne=(i,e,t)=>e.has(i)||$("Cannot "+t);var j=(i,e,t)=>(ne(i,e,"read from private field"),t?t.call(i):e.get(i)),Q=(i,e,t)=>e.has(i)?$("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);import"../chunks/CWj6FrbW.js";import{ab as w,i as s,a4 as u,Z as C,p as V,d as de,c as m,s as c,r as f,t as J,a as W,f as te}from"../chunks/TlERTnYi.js";import{d as K,t as T,a as h,c as ce,s as se}from"../chunks/CeeueTis.js";import{i as E}from"../chunks/GGSi--Df.js";import{D as ae,s as Z,e as X,i as Y}from"../chunks/D8xadzcL.js";import{a as ve,g as ue}from"../chunks/CnPPPaJN.js";import{p as ge}from"../chunks/B1ynhPFb.js";import{P as pe}from"../chunks/DIfM9HrB.js";import{a as re}from"../chunks/CrUDN0xC.js";import{S as oe}from"../chunks/B-eBv7WL.js";import{r as z,s as fe}from"../chunks/D6Y3kr68.js";import{b as H}from"../chunks/oFYcwlI3.js";import{b as ie}from"../chunks/XGGrSNVo.js";import{p as le}from"../chunks/BC8zxhgT.js";var R,B,N,U;class he{constructor(){Q(this,R,w(""));Q(this,B,w(""));Q(this,N,w(C([])));Q(this,U,w(C([])))}get dateFrom(){return s(j(this,R))}set dateFrom(e){u(j(this,R),e,!0)}get dateTo(){return s(j(this,B))}set dateTo(e){u(j(this,B),e,!0)}get includeTags(){return s(j(this,N))}set includeTags(e){u(j(this,N),e,!0)}get excludeTags(){return s(j(this,U))}set excludeTags(e){u(j(this,U),e,!0)}reset(){this.dateFrom="",this.dateTo="",this.includeTags=[],this.excludeTags=[]}applyQueryParams(e){const t=e.get("includeTags");this.includeTags=t?t.split(","):[];const l=e.get("excludeTags");this.excludeTags=l?l.split(","):[];const n=e.get("dateFrom");if(n){const g=new Date(parseInt(n));this.dateFrom=g.toISOString().slice(0,10)}const b=e.get("dateTo");if(b){const g=new Date(parseInt(b));this.dateTo=g.toISOString().slice(0,10)}}getQuery(){const e=new URLSearchParams;return this.includeTags.length>0&&e.set("includeTags",this.includeTags.join(",")),this.excludeTags.length>0&&e.set("excludeTags",this.excludeTags.join(",")),this.dateFrom&&e.set("dateFrom",new Date(this.dateFrom).getTime().toString()),this.dateTo&&e.set("dateTo",new Date(this.dateTo).getTime().toString()),e.toString()}}R=new WeakMap,B=new WeakMap,N=new WeakMap,U=new WeakMap;var _e=T('<p class="svelte-1d250rn">Use input to add tags</p>'),me=T('<div class="added unselectable svelte-1d250rn">added</div>'),Te=(i,e,t)=>e.selectedTags.push(s(t)),ye=T('<div class="add-tag-btn unselectable svelte-1d250rn">add</div>'),be=T('<div class="tag svelte-1d250rn"> <!></div>'),ke=T('<div class="adding-state svelte-1d250rn"><div class="top-elements svelte-1d250rn"><input placeholder="Search for tag..." class="svelte-1d250rn"> <svg class="close-btn svelte-1d250rn" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-1d250rn"></path></svg> <div><!></div></div> <!></div>');function we(i,e){V(e,!0);let t=w(C([])),l=w(""),n=w(C([])),b,g=null;de(()=>{const o=s(l);if(o.trim()===""){u(t,[],!0),u(n,[],!0);return}g&&clearTimeout(g),g=setTimeout(async()=>{const d=await re.fetchJsonResponse(`/post-tags/search/${encodeURIComponent(o)}`,{method:"GET"});d.isSuccess?(u(t,d.data.tags,!0),u(n,[],!0)):d&&u(n,d.errors,!0)},260)});var p=ke(),x=m(p),k=m(x);z(k),ie(k,o=>b=o,()=>b);var F=c(k,2);F.__click=function(...o){var d;(d=e.closeAddingState)==null||d.apply(this,o)};var S=c(F,2),a=m(S);{var v=o=>{var d=_e();h(o,d)},_=o=>{var d=ce(),I=te(d);X(I,17,()=>s(t),Y,(L,A)=>{var D=be(),M=m(D),O=c(M);{var G=r=>{var y=me();h(r,y)},q=r=>{var y=ye();y.__click=[Te,e,A],h(r,y)};E(O,r=>{e.selectedTags.includes(s(A))?r(G):r(q,!1)})}f(D),J(()=>se(M,`${s(A)??""} `)),h(L,D)}),h(o,d)};E(a,o=>{s(t).length===0?o(v):o(_,!1)})}f(S),f(x);var P=c(x,2);ae(P,{get errList(){return s(n)}}),f(p),J(o=>{fe(k,"name",o),Z(S,1,`searched-tags ${(s(t).length===0?"no-tags":"tags-grid")??""}`,"svelte-1d250rn")},[()=>oe.rndStrWithPref("tag-search-",12)]),H(k,()=>s(l),o=>u(l,o)),h(i,p),W()}K(["click"]);var xe=(i,e,t)=>e(s(t)),Fe=T('<div class="tag svelte-15tj9u6"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" class="svelte-15tj9u6"><path d="M19.0005 4.99988L5.00049 18.9999M5.00049 4.99988L19.0005 18.9999" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>'),Se=(i,e)=>u(e,!0),Pe=T('<button class="add-tags-btn unselectable svelte-15tj9u6">Add tags</button>'),je=T('<div class="tags svelte-15tj9u6"><!> <!></div> <!>',1);function ee(i,e){V(e,!0);let t=le(e,"selectedTags",15),l=w(!1);function n(a){t(t().filter(v=>v!==a))}var b=je(),g=te(b),p=m(g);X(p,17,t,Y,(a,v)=>{var _=Fe(),P=m(_),o=c(P);o.__click=[xe,n,v],f(_),J(()=>se(P,`${s(v)??""} `)),h(a,_)});var x=c(p,2);{var k=a=>{var v=Pe();v.__click=[Se,l],h(a,v)};E(x,a=>{s(l)||a(k)})}f(g);var F=c(g,2);{var S=a=>{we(a,{closeAddingState:()=>u(l,!1),get selectedTags(){return t()},set selectedTags(v){t(v)}})};E(F,a=>{s(l)&&a(S)})}h(i,b),W()}K(["click"]);var Ee=(i,e)=>e(i),Le=T('<span class="no-tags-selected svelte-o0y004">(No tags selected)</span>'),Ce=T('<span class="no-tags-selected svelte-o0y004">(No tags selected)</span>'),Ie=(i,e)=>e().reset(),Ae=T('<div class="container svelte-o0y004"><p>Posts filter <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" class="svelte-o0y004"><path d="M17.9998 15C17.9998 15 13.5809 9.00001 11.9998 9C10.4187 8.99999 5.99985 15 5.99985 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></p> <div><p class="filter-p svelte-o0y004">Published from: <input type="date" class="svelte-o0y004"> to: <input type="date" class="svelte-o0y004"></p> <p class="filter-p svelte-o0y004">Include tags: <!></p> <!> <p class="filter-p svelte-o0y004">Exclude tags: <!></p> <!> <div class="filter-btns svelte-o0y004"><button class="reset svelte-o0y004">Reset</button> <button class="apply svelte-o0y004">Apply</button></div></div></div>');function De(i,e){V(e,!0);let t=le(e,"postsFilter",15),l=w(!1),n;function b(r){u(l,!s(l)),n&&(n.classList.remove("rotate-down","rotate-up"),n.classList.add(s(l)?"rotate-down":"rotate-up"))}var g=Ae(),p=m(g);let x;var k=c(m(p));k.__click=[Ee,b],ie(k,r=>n=r,()=>n),f(p);var F=c(p,2);let S;var a=m(F),v=c(m(a));z(v);var _=c(v,2);z(_),f(a);var P=c(a,2),o=c(m(P));{var d=r=>{var y=Le();h(r,y)};E(o,r=>{t().includeTags.length===0&&r(d)})}f(P);var I=c(P,2);ee(I,{get selectedTags(){return t().includeTags},set selectedTags(r){t(t().includeTags=r,!0)}});var L=c(I,2),A=c(m(L));{var D=r=>{var y=Ce();h(r,y)};E(A,r=>{t().excludeTags.length===0&&r(D)})}f(L);var M=c(L,2);ee(M,{get selectedTags(){return t().excludeTags},set selectedTags(r){t(t().excludeTags=r,!0)}});var O=c(M,2),G=m(O);G.__click=[Ie,t];var q=c(G,2);q.__click=function(...r){var y;(y=e.applyFilter)==null||y.apply(this,r)},f(O),f(F),f(g),J((r,y)=>{x=Z(p,1,"always-shown unselectable svelte-o0y004",null,x,r),S=Z(F,1,"filter svelte-o0y004",null,S,y)},[()=>({"filter-not-hidden":s(l)}),()=>({hidden:!s(l)})]),H(v,()=>t().dateFrom,r=>t(t().dateFrom=r,!0)),H(_,()=>t().dateTo,r=>t(t().dateTo=r,!0)),h(i,g),W()}K(["click"]);var Me=T("<h1>There are no posts</h1>"),Qe=T('<div class="posts-container svelte-d988ns"></div>'),Re=T('<div class="page svelte-d988ns"><!> <!></div>');function $e(i,e){V(e,!0);let t=w(C(new he)),l=w(C([])),n=w(C([]));async function b(){const a=s(t).getQuery(),v=`/posts${oe.isNullOrWhiteSpace(a)?"":"?"+a}`,_=await re.fetchJsonResponse(v,{method:"GET"});_.isSuccess?(u(l,_.data.posts,!0),s(n).length!=0&&u(n,[],!0)):(u(l,[],!0),u(n,_.errors,!0))}function g(){ue(`/posts?${s(t).getQuery()}`)}ve(()=>{s(t).applyQueryParams(ge.url.searchParams),b()});var p=Re(),x=m(p);De(x,{applyFilter:g,get postsFilter(){return s(t)},set postsFilter(a){u(t,a,!0)}});var k=c(x,2);{var F=a=>{ae(a,{get errList(){return s(n)}})},S=(a,v)=>{{var _=o=>{var d=Me();h(o,d)},P=o=>{var d=Qe();X(d,21,()=>s(l),Y,(I,L)=>{pe(I,{get post(){return s(L)}})}),f(d),h(o,d)};E(a,o=>{s(l).length==0?o(_):o(P,!1)},v)}};E(k,a=>{s(n).length!=0?a(F):a(S,!1)})}f(p),h(i,p),W()}export{$e as component};
