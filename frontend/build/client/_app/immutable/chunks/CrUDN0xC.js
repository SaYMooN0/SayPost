var u=Object.defineProperty;var l=(a,s,r)=>s in a?u(a,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[s]=r;var p=(a,s,r)=>l(a,typeof s!="symbol"?s+"":s,r);import{E as c}from"./B-eBv7WL.js";import{D as f}from"./mvY8ht0J.js";class n{constructor(s){p(this,"_baseUrl");this._baseUrl=s}requestJsonOptions(s,r="POST"){return{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}}async fetchJsonResponse(s,r){try{const e=await fetch(this._baseUrl+s,{...r,credentials:"include"});if(console.log(e),e.ok){const o=await e.text();return{isSuccess:!0,data:n.parseWithDates(o)}}return{isSuccess:!1,errors:await this.parseErrResponse(e)}}catch(e){return{isSuccess:!1,errors:[new c("Unknown error",-1,"Error: "+e.message)]}}}async fetchVoidResponse(s,r){try{const e=await fetch(this._baseUrl+s,{...r,credentials:"include"});return e.ok?{isSuccess:!0}:{isSuccess:!1,errors:await this.parseErrResponse(e)}}catch(e){return{isSuccess:!1,errors:[new c("Unknown error",-1,"Error: "+e.message)]}}}async serverFetchJsonResponse(s,r,e){try{const t=await s(this._baseUrl+r,{...e,credentials:"include"});if(console.log(t),t.ok){const i=await t.text();return{isSuccess:!0,data:n.parseWithDates(i)}}const o=t.headers.get("content-type");if(o!=null&&o.includes("application/json")){const i=await t.json();if(Array.isArray(i.errors))return{isSuccess:!1,errors:i.errors}}return{isSuccess:!1,errors:[{message:"Unknown error",code:-1,details:"Response was not valid JSON with an 'errors' array"}]}}catch(t){return{isSuccess:!1,errors:[{message:"Unknown error",code:-1,details:"Exception: "+t.message}]}}}static parseWithDates(s){return JSON.parse(s,(r,e)=>typeof e=="string"&&f.isoDateRegex.test(e)?new Date(e):e)}async parseErrResponse(s){var r;if((r=s.headers.get("content-type"))!=null&&r.includes("application/json")){const e=await s.json();return Array.isArray(e.errors)?e.errors.map(c.fromPlain):[new c("Invalid error format",-1,"Expected 'errors' array in response")]}return[new c("Unknown error",-1,"Response not in JSON format")]}}const g=new n("/api/auth"),m=new n("/api/notifications"),S=new n("/api/main"),U=new n("/api/followings");export{g as A,S as a,m as b,U as c};
